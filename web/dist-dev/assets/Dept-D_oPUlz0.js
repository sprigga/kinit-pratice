var v=(x,w,f)=>new Promise((_,g)=>{var h=s=>{try{r(f.next(s))}catch(m){g(m)}},k=s=>{try{r(f.throw(s))}catch(m){g(m)}},r=s=>s.done?_(s.value):Promise.resolve(s.value).then(h,k);r((f=f.apply(x,w)).next())});import{g as T,d as N,a as I,p as P}from"./dept-HqlzFmDD.js";import{u as q,_ as J}from"./Table.vue_vue_type_script_lang-R3v9WsBF.js";import{d as M,q as c}from"./index-BsUFl8WW.js";import{_ as O}from"./ContentWrap.vue_vue_type_script_setup_true_lang-BH7Lshxr.js";import{_ as U}from"./Write.vue_vue_type_script_setup_true_lang-RF-11ccZ.js";import{_ as W}from"./Dialog.vue_vue_type_style_index_0_lang-BxUn_kyz.js";import{A as X,m as j,g as G}from"./element-plus-BDQDiIak.js";import{l as H,J as K,O as l,P as R,V as p,a as i,m as V,p as Q,R as n,u as t,S as Y,W as S,X as Z}from"./vue-chunks-DM5Q6aJS.js";import"./useForm-BPE0GJRY.js";import"./style.css_vue_type_style_index_0_src_true_lang-jwozmq-F.js";import"./wang-editor-CLgHiBvf.js";import"./_Uint8Array-DKqHwQen.js";import"./useValidator-s_gjQ478.js";const me=H({name:"AuthDept",__name:"Dept",setup(x){const{t:w}=M(),{tableRegister:f,tableState:_,tableMethods:g}=q({fetchDataApi:()=>v(this,null,function*(){const{pageSize:e,currentPage:a}=_,o=yield T({page:t(a),limit:t(e)});return{list:o.data||[],total:o.count||0}}),fetchDelApi:e=>v(this,null,function*(){return(yield N(e)).code===200})}),{dataList:h,loading:k}=_,{getList:r,delList:s}=g,m=K([{field:"name",label:"部門名稱",disabled:!0,show:!0},{field:"dept_key",label:"部門標識",show:!0},{field:"owner",label:"負責人",show:!0},{field:"phone",label:"聯絡電話",show:!0},{field:"email",label:"郵箱",show:!0},{field:"desc",label:"描述",show:!0},{field:"order",label:"排序",width:"120px",show:!0},{field:"disabled",label:"是否禁用",width:"120px",show:!0,slots:{default:e=>{const a=e.row;return l(R,null,[l(X,{modelValue:!a.disabled,disabled:!0},null)])}}},{field:"action",width:"200px",label:"操作",show:!0,slots:{default:e=>{const a=e.row;return l(R,null,[l(c,{type:"primary",link:!0,size:"small",onClick:()=>$(a)},{default:()=>[p("編輯")]}),l(c,{type:"primary",link:!0,size:"small",onClick:()=>z(a)},{default:()=>[p("添加子部門")]}),l(c,{type:"danger",loading:D.value,link:!0,size:"small",onClick:()=>E(a)},{default:()=>[p("删除")]})])}}}]),D=i(!1),E=e=>v(this,null,function*(){D.value=!0,yield s(!0,[e.id]).finally(()=>{D.value=!1})}),u=i(!1),y=i(""),b=i(),A=i(void 0),d=i(""),L=i(),C=i(!1),$=e=>{y.value="編輯",d.value="edit",b.value=e,u.value=!0},B=()=>{y.value="新增",d.value="add",b.value=void 0,u.value=!0},z=e=>{y.value="添加子部門",d.value="addSon",A.value=e.id,b.value=void 0,u.value=!0},F=()=>v(this,null,function*(){const e=t(L),a=yield e==null?void 0:e.submit();if(a){C.value=!0;try{const o=i({});d.value==="add"||d.value==="addSon"?(o.value=yield I(a),o.value&&(A.value=void 0,u.value=!1,r())):d.value==="edit"&&(o.value=yield P(a),o.value&&(u.value=!1,r()))}finally{C.value=!1}}});return(e,a)=>(V(),Q(R,null,[l(t(O),null,{default:n(()=>[l(t(J),{columns:m,showAction:"","default-expand-all":"","node-key":"id",data:t(h),loading:t(k),onRegister:t(f),onRefresh:t(r)},{toolbar:n(()=>[l(t(j),{gutter:10},{default:n(()=>[l(t(G),{span:1.5},{default:n(()=>[l(t(c),{type:"primary",onClick:B},{default:n(()=>[p("新增部門")]),_:1})]),_:1})]),_:1})]),_:1},8,["columns","data","loading","onRegister","onRefresh"])]),_:1}),l(t(W),{modelValue:u.value,"onUpdate:modelValue":a[1]||(a[1]=o=>u.value=o),title:y.value},{footer:n(()=>[d.value!=="detail"?(V(),Y(t(c),{key:0,type:"primary",loading:C.value,onClick:F},{default:n(()=>[p(S(t(w)("exampleDemo.save")),1)]),_:1},8,["loading"])):Z("",!0),l(t(c),{onClick:a[0]||(a[0]=o=>u.value=!1)},{default:n(()=>[p(S(t(w)("dialogDemo.close")),1)]),_:1})]),default:n(()=>[l(U,{ref_key:"writeRef",ref:L,"current-row":b.value,"parent-id":A.value},null,8,["current-row","parent-id"])]),_:1},8,["modelValue","title"])],64))}});export{me as default};
//# sourceMappingURL=Dept-D_oPUlz0.js.map
