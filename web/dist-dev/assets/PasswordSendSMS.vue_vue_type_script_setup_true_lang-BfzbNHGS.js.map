{"version":3,"file":"PasswordSendSMS.vue_vue_type_script_setup_true_lang-BfzbNHGS.js","sources":["../../src/views/Vadmin/Auth/User/components/PasswordSendSMS.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { ElTable, ElTableColumn, ElPopconfirm, ElMessage, ElTag } from 'element-plus'\nimport { postUsersInitPasswordSendSMSApi } from '@/api/vadmin/auth/user'\nimport { ref, PropType } from 'vue'\n\nconst props = defineProps({\n  selections: {\n    type: Object as PropType<Recordable[]>\n  }\n})\n\nconst tableData = ref(JSON.parse(JSON.stringify(props.selections)))\nconst loading = ref(false)\n\nconst handleDelete = (index: number) => {\n  tableData.value.splice(index, 1)\n}\n\nconst initPassword = async () => {\n  loading.value = true\n  const ids = tableData.value\n    .filter((item) => item.reset_password_status !== true)\n    .map((item) => item.id)\n  if (ids.length <= 0) {\n    return ElMessage.warning('已全部重置完成，無需重復操作')\n  }\n  try {\n    const res = await postUsersInitPasswordSendSMSApi(ids)\n    if (res) {\n      tableData.value = res.data\n      ElMessage.success('重置成功')\n    }\n  } finally {\n    loading.value = false\n  }\n}\n</script>\n\n<template>\n  <div>\n    <div class=\"flex justify-between\">\n      <span>已選用户列表</span>\n      <BaseButton\n        type=\"primary\"\n        :disabled=\"tableData?.length === 0\"\n        :loading=\"loading\"\n        @click=\"initPassword\"\n        >確認重置並發送短信通知</BaseButton\n      >\n    </div>\n    <ElTable\n      :data=\"tableData\"\n      :stripe=\"true\"\n      :border=\"true\"\n      style=\"width: 100%\"\n      class=\"mt-10px\"\n      max-height=\"500px\"\n    >\n      <ElTableColumn prop=\"id\" label=\"用户編號\" width=\"100\" align=\"center\" />\n      <ElTableColumn prop=\"name\" label=\"姓名\" width=\"120\" align=\"center\" />\n      <ElTableColumn prop=\"telephone\" label=\"帳號\" width=\"120\" align=\"center\" />\n      <ElTableColumn prop=\"reset_password_status\" label=\"重置狀態\" width=\"100\" align=\"center\">\n        <template #default=\"scope\">\n          <ElTag v-if=\"scope.row.reset_password_status === true\" type=\"success\" effect=\"dark\">\n            重置成功\n          </ElTag>\n          <ElTag v-else-if=\"scope.row.reset_password_status === false\" type=\"danger\" effect=\"dark\">\n            重置失敗\n          </ElTag>\n          <ElTag v-else type=\"warning\" effect=\"dark\"> 待重置 </ElTag>\n        </template>\n      </ElTableColumn>\n      <ElTableColumn prop=\"send_sms_status\" label=\"發送狀態\" width=\"100\" align=\"center\">\n        <template #default=\"scope\">\n          <ElTag v-if=\"scope.row.send_sms_status === true\" type=\"success\" effect=\"dark\">\n            發送成功\n          </ElTag>\n          <ElTag v-else-if=\"scope.row.send_sms_status === false\" type=\"danger\" effect=\"dark\">\n            發送失敗\n          </ElTag>\n          <ElTag v-else type=\"warning\" effect=\"dark\"> 待發送 </ElTag>\n        </template>\n      </ElTableColumn>\n      <ElTableColumn prop=\"send_sms_msg\" label=\"描述\" align=\"center\" />\n      <ElTableColumn fixed=\"right\" label=\"操作\" width=\"100\" align=\"center\">\n        <template #default=\"scope\">\n          <ElPopconfirm title=\"確認移除嗎?\" @confirm=\"handleDelete(scope.$index)\">\n            <template #reference>\n              <BaseButton v-if=\"scope.row.send_sms_status !== true\" link type=\"primary\" size=\"small\"\n                >移除</BaseButton\n              >\n            </template>\n          </ElPopconfirm>\n        </template>\n      </ElTableColumn>\n    </ElTable>\n  </div>\n</template>\n"],"names":["tableData","ref","__props","loading","handleDelete","index","initPassword","__async","ids","item","ElMessage","res","postUsersInitPasswordSendSMSApi"],"mappings":"wkBAWM,MAAAA,EAAYC,EAAI,KAAK,MAAM,KAAK,UANxBC,EAMwC,UAAU,CAAC,CAAC,EAC5DC,EAAUF,EAAI,EAAK,EAEnBG,EAAgBC,GAAkB,CAC5BL,EAAA,MAAM,OAAOK,EAAO,CAAC,CAAA,EAG3BC,EAAe,IAAYC,EAAA,sBAC/BJ,EAAQ,MAAQ,GAChB,MAAMK,EAAMR,EAAU,MACnB,OAAQS,GAASA,EAAK,wBAA0B,EAAI,EACpD,IAAKA,GAASA,EAAK,EAAE,EACpB,GAAAD,EAAI,QAAU,EACT,OAAAE,EAAU,QAAQ,gBAAgB,EAEvC,GAAA,CACI,MAAAC,EAAM,MAAMC,EAAgCJ,CAAG,EACjDG,IACFX,EAAU,MAAQW,EAAI,KACtBD,EAAU,QAAQ,MAAM,EAC1B,QACA,CACAP,EAAQ,MAAQ,EAClB,CAAA"}