var X=Object.defineProperty;var O=Object.getOwnPropertySymbols;var Y=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable;var I=(a,i,l)=>i in a?X(a,i,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[i]=l,B=(a,i)=>{for(var l in i||(i={}))Y.call(i,l)&&I(a,l,i[l]);if(O)for(var l of O(i))Z.call(i,l)&&I(a,l,i[l]);return a};var f=(a,i,l)=>new Promise((w,h)=>{var C=o=>{try{v(l.next(o))}catch(p){h(p)}},P=o=>{try{v(l.throw(o))}catch(p){h(p)}},v=o=>o.done?w(o.value):Promise.resolve(o.value).then(C,P);v((l=l.apply(a,i)).next())});import{r as _,d as ee,q as g}from"./index-BsUFl8WW.js";import{u as te,_ as ae}from"./Table.vue_vue_type_script_lang-R3v9WsBF.js";import{_ as le}from"./Search.vue_vue_type_script_setup_true_lang-D2iD-Cem.js";import{_ as se}from"./ContentWrap.vue_vue_type_script_setup_true_lang-BH7Lshxr.js";import{_ as ie}from"./Write.vue_vue_type_script_setup_true_lang-DMEBZ13s.js";import{_ as re}from"./Dialog.vue_vue_type_style_index_0_lang-BxUn_kyz.js";import{u as oe}from"./dict-ttqq3e93.js";import{m as ne,g as ue}from"./element-plus-BDQDiIak.js";import{l as ce,a as u,J as E,O as r,_ as x,ar as A,V as y,P as T,m as F,p as pe,R as c,u as t,B as U,S as de,W as q}from"./vue-chunks-DM5Q6aJS.js";import"./useForm-BPE0GJRY.js";import"./style.css_vue_type_style_index_0_src_true_lang-jwozmq-F.js";import"./wang-editor-CLgHiBvf.js";import"./_Uint8Array-DKqHwQen.js";import"./useIcon-CGEWj5sB.js";import"./useValidator-s_gjQ478.js";import"./dict-Dgnb-fjD.js";const me=a=>_.get({url:"/crm/visit/reply",params:a}),fe=a=>_.post({url:"/crm/visit/reply",data:a}),ve=a=>_.delete({url:"/crm/visit/reply",data:a}),ge=a=>_.put({url:`/crm/visit/reply/${a.id}`,data:a}),ye=a=>_.get({url:`crm/visit/reply/${a}`}),Be=ce({name:"CrmVisitReply",__name:"Reply",setup(a){const{t:i}=ee(),{tableRegister:l,tableState:w,tableMethods:h}=te({fetchDataApi:()=>f(this,null,function*(){const{pageSize:s,currentPage:e}=w,n=yield me(B({page:t(e),limit:t(s)},t($)));return{list:n.data||[],total:n.count||0}}),fetchDelApi:s=>f(this,null,function*(){return(yield ve(s)).code===200})}),{dataList:C,loading:P,total:v,pageSize:o,currentPage:p}=w,{getList:R,delList:N}=h,j=u([]);f(this,null,function*(){const e=yield oe().getDictObj(["sys_vadmin_platform"]);j.value=e.sys_vadmin_platform});const J=E([{field:"action",label:"操作",width:"200px",show:!0,slots:{default:s=>{const e=s.row,n=["crm.visit.reply.update"],d=["crm.visit.reply.delete"];return r(T,null,[x(r(g,{type:"primary",link:!0,size:"small",onClick:()=>G(e)},{default:()=>[y("編輯")]}),[[A("hasPermi"),n]]),x(r(g,{type:"danger",loading:V.value,link:!0,size:"small",onClick:()=>W(e)},{default:()=>[y("删除")]}),[[A("hasPermi"),d]])])}}}]),M=E([{field:"id",label:"流水號",component:"Input",componentProps:{clearable:!0,style:{width:"214px"}}},{field:"record_id",label:"對應主檔",component:"Input",componentProps:{clearable:!0,style:{width:"214px"}}},{field:"record",label:"回覆內容",component:"Input",componentProps:{clearable:!0,style:{width:"214px"}}},{field:"create_datetime",label:"建立時間",component:"Input",componentProps:{clearable:!0,style:{width:"214px"}}}]),$=u({}),z=s=>{p.value=1,$.value=s,R()},V=u(!1),W=s=>f(this,null,function*(){V.value=!0,yield N(!0,[s.id]).finally(()=>{V.value=!1})}),m=u(!1),k=u(""),D=u(),b=u(""),L=u(),S=u(!1),G=s=>f(this,null,function*(){const e=yield ye(s.id);e&&(k.value="編輯資料",b.value="edit",D.value=e.data,m.value=!0)}),H=()=>{k.value="新增資料",b.value="add",D.value=void 0,m.value=!0},K=["crm.visit.reply.create"],Q=()=>f(this,null,function*(){const s=t(L),e=yield s==null?void 0:s.submit();if(e){S.value=!0;try{const n=u({});b.value==="add"?(n.value=yield fe(e),n.value&&(m.value=!1,R())):b.value==="edit"&&(n.value=yield ge(e),n.value&&(m.value=!1,R()))}finally{S.value=!1}}});return(s,e)=>{const n=A("hasPermi");return F(),pe(T,null,[r(t(se),null,{default:c(()=>[r(t(le),{schema:M,onReset:z,onSearch:z},null,8,["schema"]),r(t(ae),{"current-page":t(p),"onUpdate:currentPage":e[0]||(e[0]=d=>U(p)?p.value=d:null),"page-size":t(o),"onUpdate:pageSize":e[1]||(e[1]=d=>U(o)?o.value=d:null),showAction:"",columns:J,"default-expand-all":"","node-key":"id",data:t(C),loading:t(P),pagination:{total:t(v)},onRegister:t(l),onRefresh:t(R)},{toolbar:c(()=>[r(t(ne),{gutter:10},{default:c(()=>[r(t(ue),{span:1.5},{default:c(()=>[x((F(),de(t(g),{type:"primary",onClick:H},{default:c(()=>[y("新增資料")]),_:1})),[[n,{add:K}]])]),_:1})]),_:1})]),_:1},8,["current-page","page-size","columns","data","loading","pagination","onRegister","onRefresh"])]),_:1}),r(t(re),{modelValue:m.value,"onUpdate:modelValue":e[3]||(e[3]=d=>m.value=d),title:k.value,height:650},{footer:c(()=>[r(t(g),{type:"primary",loading:S.value,onClick:Q},{default:c(()=>[y(q(t(i)("exampleDemo.save")),1)]),_:1},8,["loading"]),r(t(g),{onClick:e[2]||(e[2]=d=>m.value=!1)},{default:c(()=>[y(q(t(i)("dialogDemo.close")),1)]),_:1})]),default:c(()=>[r(ie,{ref_key:"writeRef",ref:L,"current-row":D.value},null,8,["current-row"])]),_:1},8,["modelValue","title"])],64)}}});export{Be as default};
//# sourceMappingURL=Reply-Cv8uiq73.js.map
