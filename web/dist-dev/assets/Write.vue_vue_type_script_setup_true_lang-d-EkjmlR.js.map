{"version":3,"file":"Write.vue_vue_type_script_setup_true_lang-d-EkjmlR.js","sources":["../../src/views/Vadmin/Auth/Menu/components/Write.vue"],"sourcesContent":["<script setup lang=\"tsx\">\nimport { Form, FormSchema } from '@/components/Form'\nimport { useForm } from '@/hooks/web/useForm'\nimport { PropType, reactive, watch } from 'vue'\nimport { useValidator } from '@/hooks/web/useValidator'\nimport { propTypes } from '@/utils/propTypes'\nimport { getMenuTreeOptionsApi } from '@/api/vadmin/auth/menu'\nimport { IconPicker } from '@/components/IconPicker'\nimport { BaseButton } from '@/components/Button'\n\nconst { required } = useValidator()\n\nconst props = defineProps({\n  currentRow: {\n    type: Object as PropType<any>,\n    default: () => null\n  },\n  parentId: propTypes.number.def(undefined)\n})\n\nconst toIconify = () => {\n  window.open('https://iconify.design/')\n}\n\nconst formSchema = reactive<FormSchema[]>([\n  {\n    field: 'parent_id',\n    label: '上级選單',\n    colProps: {\n      span: 24\n    },\n    component: 'TreeSelect',\n    componentProps: {\n      style: {\n        width: '100%'\n      },\n      checkStrictly: true,\n      placeholder: '請選擇上级選單',\n      nodeKey: 'value',\n      defaultExpandAll: true\n    },\n    optionApi: async () => {\n      const res = await getMenuTreeOptionsApi()\n      return res.data\n    },\n    value: props.parentId\n  },\n  {\n    field: 'menu_type',\n    label: '選單類型',\n    colProps: {\n      span: 24\n    },\n    component: 'RadioGroup',\n    componentProps: {\n      style: {\n        width: '100%'\n      },\n      options: [\n        {\n          label: '目錄',\n          value: '0'\n        },\n        {\n          label: '選單',\n          value: '1'\n        },\n        {\n          label: '按钮',\n          value: '2'\n        }\n      ]\n    },\n    value: '0'\n  },\n  {\n    field: 'icon',\n    label: '選單圖標',\n    colProps: {\n      span: 24\n    },\n    component: 'Input',\n    formItemProps: {\n      slots: {\n        default: (data) => {\n          return (\n            <>\n              <div style=\"display: flex; justify-content: space-between\">\n                <IconPicker style=\"width: 435px\" input-disabled={false} v-model={data['icon']} />\n                <div style=\"margin-left: 10px\">\n                  <BaseButton type=\"primary\" onClick={toIconify}>\n                    Iconify\n                  </BaseButton>\n                </div>\n              </div>\n            </>\n          )\n        }\n      }\n    },\n    ifshow: (formModel) => formModel.menu_type !== '2'\n  },\n  {\n    field: 'title',\n    label: '選單名稱',\n    component: 'Input',\n    colProps: {\n      span: 12\n    }\n  },\n  {\n    field: 'order',\n    label: '顯示排序',\n    component: 'InputNumber',\n    colProps: {\n      span: 12\n    },\n    componentProps: {\n      style: {\n        width: '100%'\n      }\n    }\n  },\n  {\n    field: 'path',\n    label: '路由地址',\n    component: 'Input',\n    colProps: {\n      span: 12\n    },\n    ifshow: (formModel) => formModel.menu_type !== '2'\n  },\n  {\n    field: 'component',\n    label: '组件路徑',\n    component: 'Input',\n    colProps: {\n      span: 12\n    },\n    ifshow: (formModel) => formModel.menu_type !== '2'\n  },\n  {\n    field: 'redirect',\n    label: '重定向',\n    component: 'Input',\n    colProps: {\n      span: 12\n    },\n    ifshow: (formModel) => formModel.menu_type !== '2'\n  },\n  {\n    field: 'hidden',\n    label: '顯示狀態',\n    colProps: {\n      span: 12\n    },\n    component: 'RadioGroup',\n    componentProps: {\n      style: {\n        width: '100%'\n      },\n      options: [\n        {\n          label: '顯示',\n          value: false\n        },\n        {\n          label: '隱藏',\n          value: true\n        }\n      ]\n    },\n    value: false,\n    ifshow: (formModel) => formModel.menu_type !== '2'\n  },\n  {\n    field: 'disabled',\n    label: '選單狀態',\n    colProps: {\n      span: 12\n    },\n    component: 'RadioGroup',\n    componentProps: {\n      style: {\n        width: '100%'\n      },\n      options: [\n        {\n          label: '正常',\n          value: false\n        },\n        {\n          label: '停用',\n          value: true\n        }\n      ]\n    },\n    value: false,\n    ifshow: (formModel) => formModel.menu_type !== '2'\n  },\n  {\n    field: 'perms',\n    label: '權限標識',\n    component: 'Input',\n    colProps: {\n      span: 12\n    },\n    ifshow: (formModel) => formModel.menu_type === '2'\n  },\n  {\n    field: 'noCache',\n    label: '頁面緩存',\n    colProps: {\n      span: 12\n    },\n    component: 'RadioGroup',\n    componentProps: {\n      style: {\n        width: '100%'\n      },\n      options: [\n        {\n          label: '緩存',\n          value: false\n        },\n        {\n          label: '不緩存',\n          value: true\n        }\n      ]\n    },\n    value: false,\n    ifshow: (formModel) => formModel.menu_type === '1',\n    labelMessage: '開啟頁面緩存,需要组件名稱必須與xx.vue頁面的name一致'\n  }\n])\n\nconst rules = reactive({\n  title: [required()],\n  menu_type: [required()],\n  disabled: [required()],\n  hidden: [required()],\n  path: [required()],\n  noCache: [required()],\n  order: [required()]\n})\n\nconst { formRegister, formMethods } = useForm()\nconst { setValues, getFormData, getElFormExpose } = formMethods\n\nconst submit = async () => {\n  const elForm = await getElFormExpose()\n  const valid = await elForm?.validate()\n  if (valid) {\n    const formData = await getFormData()\n    return formData\n  }\n}\n\nwatch(\n  () => props.currentRow,\n  (currentRow) => {\n    if (!currentRow) return\n    setValues(currentRow)\n  },\n  {\n    deep: true,\n    immediate: true\n  }\n)\n\ndefineExpose({\n  submit\n})\n</script>\n\n<template>\n  <Form :rules=\"rules\" @register=\"formRegister\" :schema=\"formSchema\" :labelWidth=\"100\" />\n</template>\n"],"names":["required","useValidator","props","__props","toIconify","window","open","formSchema","reactive","field","label","colProps","span","component","componentProps","style","width","checkStrictly","placeholder","nodeKey","defaultExpandAll","optionApi","__async","getMenuTreeOptionsApi","data","value","parentId","options","formItemProps","slots","default","_createVNode","_Fragment","IconPicker","$event","BaseButton","_createTextVNode","ifshow","formModel","menu_type","labelMessage","rules","title","disabled","hidden","path","noCache","order","formRegister","formMethods","useForm","setValues","getFormData","getElFormExpose","submit","elForm","validate","watch","currentRow","deep","immediate","__expose"],"mappings":"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"}