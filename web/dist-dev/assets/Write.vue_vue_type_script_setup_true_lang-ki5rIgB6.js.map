{"version":3,"file":"Write.vue_vue_type_script_setup_true_lang-ki5rIgB6.js","sources":["../../src/views/Crm/Visit/Record/components/Write.vue"],"sourcesContent":["<script setup lang=\"tsx\">\nimport { Form, FormSchema } from '@/components/Form'\nimport { useForm } from '@/hooks/web/useForm'\nimport { PropType, reactive, watch } from 'vue'\nimport { useValidator } from '@/hooks/web/useValidator'\nimport { useDictStore } from '@/store/modules/dict'\n\nconst { required } = useValidator()\n\nconst props = defineProps({\n  currentRow: {\n    type: Object as PropType<any>,\n    default: () => null\n  }\n})\n\nconst formSchema = reactive<FormSchema[]>([\n  {\n    field: 'visit_period',\n    label: '拜訪時段',\n    colProps: {\n      span: 12\n    },\n    component: 'Input',\n    componentProps: {\n      style: {\n        width: '100%'\n      }\n    }\n  },\n  {\n    field: 'name',\n    label: '業務姓名',\n    colProps: {\n      span: 12\n    },\n    component: 'Input',\n    componentProps: {\n      style: {\n        width: '100%'\n      }\n    }\n  },\n  {\n    field: 'customer_type',\n    label: '拜訪店類型',\n    colProps: {\n      span: 12\n    },\n    component: 'Input',\n    componentProps: {\n      style: {\n        width: '100%'\n      }\n    }\n  },\n  {\n    field: 'customer_name',\n    label: '客戶名稱／交談對象',\n    colProps: {\n      span: 12\n    },\n    component: 'Input',\n    componentProps: {\n      clearable: true,\n      options: []\n    }\n  },\n  {\n    field: 'resolved_date',\n    label: '結案時間',\n    component: 'DatePicker',\n    colProps: {\n      span: 12\n    },\n    componentProps: {\n      style: {\n        width: '100%'\n      },\n      type: 'date',\n      format: 'YYYY-MM-DD',\n      valueFormat: 'YYYY-MM-DD'\n    },\n    formItemProps: {\n      rules: [required()]\n    }\n  },\n  {\n    field: 'purpose',\n    label: '拜訪目的',\n    colProps: {\n      span: 12\n    },\n    component: 'Input',\n    componentProps: {\n      style: {\n        width: '100%'\n      }\n    }\n  },\n  {\n    field: 'content',\n    label: '拜訪內容／業界動態',\n    colProps: {\n      span: 24\n    },\n    component: 'Input', // 使用 Input\n    componentProps: {\n      type: 'textarea', // 關鍵在這\n      rows: 4, // 顯示高度\n      style: {\n        width: '100%'\n      }\n    }\n  },\n  {\n    field: 'issue_type',\n    label: '問題類型',\n    colProps: {\n      span: 12\n    },\n    component: 'Select',\n    componentProps: {\n      style: {\n        width: '100%'\n      }\n    },\n    optionApi: async () => {\n      const dictStore = useDictStore()\n      const dictOptions = await dictStore.getDictObj(['crm_record_issue_type'])\n      return dictOptions.crm_record_issue_type\n    },\n    formItemProps: {\n      rules: [required()]\n    }\n  },\n  {\n    field: 'assigned_user',\n    label: '指派人員',\n    colProps: {\n      span: 12\n    },\n    component: 'Select',\n    componentProps: {\n      style: {\n        width: '100%'\n      }\n    },\n    optionApi: async () => {\n      const dictStore = useDictStore()\n      const dictOptions = await dictStore.getDictObj(['crm_record_assigned_user'])\n      return dictOptions.crm_record_assigned_user\n    },\n    formItemProps: {\n      rules: [required()]\n    }\n  },\n  {\n    field: 'estimated_reply_date',\n    label: '指定回覆時間',\n    component: 'DatePicker',\n    colProps: {\n      span: 12\n    },\n    componentProps: {\n      style: {\n        width: '100%'\n      },\n      type: 'datetime',\n      format: 'YYYY-MM-DD HH:mm:ss',\n      valueFormat: 'YYYY-MM-DD HH:mm:ss'\n    },\n    formItemProps: {\n      rules: [required()]\n    }\n  },\n  {\n    field: 'is_closed',\n    label: '是否結案',\n    colProps: {\n      span: 12\n    },\n    component: 'RadioGroup',\n    componentProps: {\n      style: {\n        width: '100%'\n      },\n      options: [\n        {\n          label: '結案',\n          value: true\n        },\n        {\n          label: '未結案',\n          value: false\n        }\n      ]\n    },\n    value: true\n  }\n])\n\nconst rules = reactive({\n  visit_date: [required()],\n  sales_name: [required()],\n  client_name: [required()],\n  visit_type: [required()],\n  purpose: [required()],\n  is_closed: [required()]\n})\n\nconst { formRegister, formMethods } = useForm()\nconst { setValues, getFormData, getElFormExpose } = formMethods\n\nconst submit = async () => {\n  const elForm = await getElFormExpose()\n  const valid = await elForm?.validate()\n  if (valid) {\n    const formData = await getFormData()\n    return formData\n  }\n}\n\nwatch(\n  () => props.currentRow,\n  (currentRow) => {\n    if (!currentRow) return\n    setValues(currentRow)\n  },\n  {\n    deep: true,\n    immediate: true\n  }\n)\n\ndefineExpose({\n  submit\n})\n</script>\n\n<template>\n  <Form :rules=\"rules\" @register=\"formRegister\" :schema=\"formSchema\" />\n</template>\n"],"names":["required","useValidator","props","__props","formSchema","reactive","field","label","colProps","span","component","componentProps","style","width","clearable","options","type","format","valueFormat","formItemProps","rules","rows","optionApi","__async","useDictStore","getDictObj","crm_record_issue_type","crm_record_assigned_user","value","visit_date","sales_name","client_name","visit_type","purpose","is_closed","formRegister","formMethods","useForm","setValues","getFormData","getElFormExpose","submit","elForm","validate","watch","currentRow","deep","immediate","__expose"],"mappings":"+fAOA,KAAM,CAAEA,SAAAA,CAAU,EAAGC,EAAY,EAE3BC,EAAQC,EAORC,EAAaC,EAAuB,CACxC,CACEC,MAAO,eACPC,MAAO,OACPC,SAAU,CACRC,KAAM,EACP,EACDC,UAAW,QACXC,eAAgB,CACdC,MAAO,CACLC,MAAO,MACT,CACF,CACF,EACA,CACEP,MAAO,OACPC,MAAO,OACPC,SAAU,CACRC,KAAM,EACP,EACDC,UAAW,QACXC,eAAgB,CACdC,MAAO,CACLC,MAAO,MACT,CACF,CACF,EACA,CACEP,MAAO,gBACPC,MAAO,QACPC,SAAU,CACRC,KAAM,EACP,EACDC,UAAW,QACXC,eAAgB,CACdC,MAAO,CACLC,MAAO,MACT,CACF,CACF,EACA,CACEP,MAAO,gBACPC,MAAO,YACPC,SAAU,CACRC,KAAM,EACP,EACDC,UAAW,QACXC,eAAgB,CACdG,UAAW,GACXC,QAAS,CAAA,CACX,CACF,EACA,CACET,MAAO,gBACPC,MAAO,OACPG,UAAW,aACXF,SAAU,CACRC,KAAM,EACP,EACDE,eAAgB,CACdC,MAAO,CACLC,MAAO,MACR,EACDG,KAAM,OACNC,OAAQ,aACRC,YAAa,YACd,EACDC,cAAe,CACbC,MAAO,CAACpB,GAAU,CACpB,CACF,EACA,CACEM,MAAO,UACPC,MAAO,OACPC,SAAU,CACRC,KAAM,EACP,EACDC,UAAW,QACXC,eAAgB,CACdC,MAAO,CACLC,MAAO,MACT,CACF,CACF,EACA,CACEP,MAAO,UACPC,MAAO,YACPC,SAAU,CACRC,KAAM,EACP,EACDC,UAAW,QACXC,eAAgB,CACdK,KAAM,WACNK,KAAM,EACNT,MAAO,CACLC,MAAO,MACT,CACF,CACF,EACA,CACEP,MAAO,aACPC,MAAO,OACPC,SAAU,CACRC,KAAM,EACP,EACDC,UAAW,SACXC,eAAgB,CACdC,MAAO,CACLC,MAAO,MACT,CACD,EACDS,UAAW,IAAYC,EAAA,sBAGrB,OADoB,MADFC,IACkBC,WAAW,CAAC,uBAAuB,CAAC,GACrDC,qBACpB,GACDP,cAAe,CACbC,MAAO,CAACpB,GAAU,CACpB,CACF,EACA,CACEM,MAAO,gBACPC,MAAO,OACPC,SAAU,CACRC,KAAM,EACP,EACDC,UAAW,SACXC,eAAgB,CACdC,MAAO,CACLC,MAAO,MACT,CACD,EACDS,UAAW,IAAYC,EAAA,sBAGrB,OADoB,MADFC,IACkBC,WAAW,CAAC,0BAA0B,CAAC,GACxDE,wBACpB,GACDR,cAAe,CACbC,MAAO,CAACpB,GAAU,CACpB,CACF,EACA,CACEM,MAAO,uBACPC,MAAO,SACPG,UAAW,aACXF,SAAU,CACRC,KAAM,EACP,EACDE,eAAgB,CACdC,MAAO,CACLC,MAAO,MACR,EACDG,KAAM,WACNC,OAAQ,sBACRC,YAAa,qBACd,EACDC,cAAe,CACbC,MAAO,CAACpB,GAAU,CACpB,CACF,EACA,CACEM,MAAO,YACPC,MAAO,OACPC,SAAU,CACRC,KAAM,EACP,EACDC,UAAW,aACXC,eAAgB,CACdC,MAAO,CACLC,MAAO,MACR,EACDE,QAAS,CACP,CACER,MAAO,KACPqB,MAAO,EACT,EACA,CACErB,MAAO,MACPqB,MAAO,GACT,CAEH,EACDA,MAAO,EACT,CAAA,CACD,EAEKR,EAAQf,EAAS,CACrBwB,WAAY,CAAC7B,GAAU,EACvB8B,WAAY,CAAC9B,GAAU,EACvB+B,YAAa,CAAC/B,GAAU,EACxBgC,WAAY,CAAChC,GAAU,EACvBiC,QAAS,CAACjC,GAAU,EACpBkC,UAAW,CAAClC,GAAU,CACxB,CAAC,EAEK,CAAEmC,aAAAA,EAAcC,YAAAA,CAAa,EAAGC,EAAO,EACvC,CAAEC,UAAAA,EAAWC,YAAAA,EAAaC,gBAAAA,CAAiB,EAAGJ,EAE9CK,EAAS,IAAYlB,EAAA,sBACzB,MAAMmB,EAAS,MAAMF,IAErB,GADc,MAAME,GAAAA,YAAAA,EAAQC,WAG1B,OADiB,MAAMJ,MAK3BK,OAAAA,EACE,IAAM1C,EAAM2C,WACXA,GAAe,CACTA,GACLP,EAAUO,CAAU,CACtB,EACA,CACEC,KAAM,GACNC,UAAW,EACb,CACF,EAEAC,EAAa,CACXP,OAAAA,CACF,CAAC"}