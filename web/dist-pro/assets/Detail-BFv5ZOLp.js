var Q=Object.defineProperty;var V=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var $=(n,l,a)=>l in n?Q(n,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[l]=a,L=(n,l)=>{for(var a in l||(l={}))X.call(l,a)&&$(n,a,l[a]);if(V)for(var a of V(l))Y.call(l,a)&&$(n,a,l[a]);return n};var f=(n,l,a)=>new Promise((w,h)=>{var D=s=>{try{v(a.next(s))}catch(u){h(u)}},x=s=>{try{v(a.throw(s))}catch(u){h(u)}},v=s=>s.done?w(s.value):Promise.resolve(s.value).then(D,x);v((a=a.apply(n,l)).next())});import{g as Z,a as ee,d as te,b as ae,p as ie}from"./detail-CB3lAfFE.js";import{u as le,_ as oe}from"./Table.vue_vue_type_script_lang-Baw7Xmjh.js";import{d as se,q as g}from"./index-TVUJ5EGw.js";/* empty css               */import{_ as re}from"./Search.vue_vue_type_script_setup_true_lang-BR3CMH1C.js";import{_ as ne}from"./ContentWrap.vue_vue_type_script_setup_true_lang-BSPWmg2w.js";import{_ as de}from"./Write.vue_vue_type_script_setup_true_lang-Du7NY8eG.js";import{_ as pe}from"./Dialog.vue_vue_type_style_index_0_lang-DwvSpjk1.js";import{u as ue}from"./dict-CCE9svEJ.js";import{n as me,h as ce}from"./element-plus-DaxMU9jX.js";import{l as fe,a as d,J as O,O as o,_ as A,ar as B,V as _,P as E,m as T,p as ve,R as p,u as t,B as F,S as ge,W as U}from"./vue-chunks-DM5Q6aJS.js";/* empty css                       *//* empty css                 *//* empty css                   *//* empty css                        *//* empty css               */import"./el-tooltip-l0sNRNKZ.js";/* empty css                  */import"./useForm-8sSQvRCB.js";/* empty css                          *//* empty css                        *//* empty css                       *//* empty css                *//* empty css                  *//* empty css                   *//* empty css                    */import"./style.css_vue_type_style_index_0_src_true_lang-DFMD74RT.js";import"./wang-editor-kNnY1XhY.js";/* empty css                   *//* empty css                    *//* empty css                        *//* empty css                *//* empty css                         */import"./_Uint8Array-DKqHwQen.js";import"./useIcon-BGF3iNGO.js";import"./useValidator-D0Zw1fFG.js";import"./dict-BKIVAwf4.js";const at=fe({name:"BpminItDetail",__name:"Detail",setup(n){const{t:l}=se(),{tableRegister:a,tableState:w,tableMethods:h}=le({fetchDataApi:()=>f(this,null,function*(){const{pageSize:i,currentPage:e}=w,r=yield ee(L({page:t(e),limit:t(i)},t(C)));return{list:r.data||[],total:r.count||0}}),fetchDelApi:i=>f(this,null,function*(){return(yield te(i)).code===200})}),{dataList:D,loading:x,total:v,pageSize:s,currentPage:u}=w,{getList:b,delList:N}=h,j=d([]);f(this,null,function*(){const e=yield ue().getDictObj(["sys_vadmin_platform"]);j.value=e.sys_vadmin_platform});const q=O([{field:"work_desc",label:"需求描述",width:"150px",show:!0,disabled:!0},{field:"rsn",label:"參照序號",width:"150px",show:!0,disabled:!0},{field:"status",label:"狀態",width:"150px",show:!0,disabled:!0},{field:"create_datetime",label:"創建時間",width:"150px",show:!0,disabled:!0},{field:"update_datetime",label:"更新時間",width:"150px",show:!0,disabled:!0},{field:"action",label:"操作",width:"200px",show:!0,slots:{default:i=>{const e=i.row,r=["bpmin.it.detail.update"],m=["bpmin.it.detail.delete"];return o(E,null,[A(o(g,{type:"primary",link:!0,size:"small",onClick:()=>W(e)},{default:()=>[_("編輯")]}),[[B("hasPermi"),r]]),A(o(g,{type:"danger",loading:k.value,link:!0,size:"small",onClick:()=>M(e)},{default:()=>[_("删除")]}),[[B("hasPermi"),m]])])}}}]),J=O([{field:"create_datetime",label:"創建時間",component:"Input",componentProps:{clearable:!0,style:{width:"214px"}}},{field:"update_datetime",label:"更新時間",component:"Input",componentProps:{clearable:!0,style:{width:"214px"}}}]),C=d({}),I=i=>{u.value=1,C.value=i,b()},k=d(!1),M=i=>f(this,null,function*(){k.value=!0,yield N(!0,[i.id]).finally(()=>{k.value=!1})}),c=d(!1),P=d(""),R=d(),y=d(""),z=d(),S=d(!1),W=i=>f(this,null,function*(){const e=yield Z(i.id);e&&(P.value="編輯資料",y.value="edit",R.value=e.data,c.value=!0)}),G=()=>{P.value="新增資料",y.value="add",R.value=void 0,c.value=!0},H=["bpmin.it.detail.create"],K=()=>f(this,null,function*(){const i=t(z),e=yield i==null?void 0:i.submit();if(e){S.value=!0;try{const r=d({});y.value==="add"?(r.value=yield ae(e),r.value&&(c.value=!1,b())):y.value==="edit"&&(r.value=yield ie(e),r.value&&(c.value=!1,b()))}finally{S.value=!1}}});return(i,e)=>{const r=B("hasPermi");return T(),ve(E,null,[o(t(ne),null,{default:p(()=>[o(t(re),{schema:J,onReset:I,onSearch:I},null,8,["schema"]),o(t(oe),{"current-page":t(u),"onUpdate:currentPage":e[0]||(e[0]=m=>F(u)?u.value=m:null),"page-size":t(s),"onUpdate:pageSize":e[1]||(e[1]=m=>F(s)?s.value=m:null),showAction:"",columns:q,"default-expand-all":"","node-key":"id",data:t(D),loading:t(x),pagination:{total:t(v)},onRegister:t(a),onRefresh:t(b)},{toolbar:p(()=>[o(t(me),{gutter:10},{default:p(()=>[o(t(ce),{span:1.5},{default:p(()=>[A((T(),ge(t(g),{type:"primary",onClick:G},{default:p(()=>[_("新增資料")]),_:1})),[[r,{add:H}]])]),_:1})]),_:1})]),_:1},8,["current-page","page-size","columns","data","loading","pagination","onRegister","onRefresh"])]),_:1}),o(t(pe),{modelValue:c.value,"onUpdate:modelValue":e[3]||(e[3]=m=>c.value=m),title:P.value,height:650},{footer:p(()=>[o(t(g),{type:"primary",loading:S.value,onClick:K},{default:p(()=>[_(U(t(l)("exampleDemo.save")),1)]),_:1},8,["loading"]),o(t(g),{onClick:e[2]||(e[2]=m=>c.value=!1)},{default:p(()=>[_(U(t(l)("dialogDemo.close")),1)]),_:1})]),default:p(()=>[o(de,{ref_key:"writeRef",ref:z,"current-row":R.value},null,8,["current-row"])]),_:1},8,["modelValue","title"])],64)}}});export{at as default};
