var _=(o,d,a)=>new Promise((u,p)=>{var m=t=>{try{s(a.next(t))}catch(i){p(i)}},f=t=>{try{s(a.throw(t))}catch(i){p(i)}},s=t=>t.done?u(t.value):Promise.resolve(t.value).then(m,f);s((a=a.apply(o,d)).next())});import{u as C,F as A}from"./useForm-DBy6iRN_.js";import{u as E}from"./useValidator-3LOiG8nN.js";import{u as F,a as q,e as M,p as N,g as U,_ as D}from"./index-ZB82WqWX.js";import{l as H,aB as J,e as O,J as T,a as w,b as X,ah as $,m as v,p as j,q as c,O as R,u as h,R as z,V as G,S as K,X as L,aH as Q,aI as W}from"./vue-chunks-DM5Q6aJS.js";import{_ as Y}from"./Footer.vue_vue_type_script_setup_true_lang-CFIPCqlA.js";import{b as Z}from"./element-plus-BZE4vQ0t.js";/* empty css               */import"./el-tooltip-l0sNRNKZ.js";/* empty css                  *//* empty css                 *//* empty css               *//* empty css                          *//* empty css                        *//* empty css                       *//* empty css                *//* empty css                  *//* empty css                   *//* empty css                    */import"./style.css_vue_type_style_index_0_src_true_lang-7xoOJBR1.js";import"./wang-editor-kNnY1XhY.js";/* empty css                   *//* empty css                    */const ee=o=>(Q("data-v-def966f8"),o=o(),W(),o),te={class:"main-container"},se={class:"form-container"},oe=ee(()=>c("div",null,[c("h2",{class:"text-2xl font-bold text-center w-[100%]"},"第一次登錄系统，需先重置密碼")],-1)),ae={class:"w-[100%]"},re={class:"footer-container"},ie=H({__name:"Reset",setup(o){const{required:d}=E(),{addRoute:a,push:u,currentRoute:p}=J(),m=F(),f=q(),s=M(),t=O(()=>f.getFooter),i=T([{field:"password",label:"新密碼",component:"InputPassword",colProps:{span:24},componentProps:{style:{width:"100%"},placeholder:"請輸入新密碼"}},{field:"password_two",label:"再次輸入新密碼",component:"InputPassword",colProps:{span:24},componentProps:{style:{width:"100%"},placeholder:"請再次輸入新密碼"}}]),b={password:[d(),{min:8,max:16,message:"長度需為8-16個字符,請重新輸入。",trigger:"blur"}],password_two:[d(),{min:8,max:16,message:"長度需為8-16個字符,請重新輸入。",trigger:"blur"}]},{formRegister:x,formMethods:S}=C(),{setValues:k,getFormData:y,getElFormExpose:B}=S;k(m.getUser);const l=w(!1),g=w("");X(()=>p.value,e=>{var r;g.value=(r=e==null?void 0:e.query)==null?void 0:r.redirect},{immediate:!0});const I=()=>_(this,null,function*(){if(m.getUser.id===1)return Z.warning("編輯帳號為演示帳號，無權限操作！");const e=yield B();if(yield e==null?void 0:e.validate()){l.value=!0;const n=yield y();try{(yield N(n))?P():l.value=!1}catch(V){l.value=!1}}}),P=()=>_(this,null,function*(){const e=yield U();if(e){const r=e.data||[];yield s.generateRoutes(r).catch(()=>{}),s.getAddRouters.forEach(n=>{a(n)}),s.setIsAddRouters(!0),u({path:g.value||s.addRouters[0].path})}});return(e,r)=>{const n=$("BaseButton");return v(),j("div",te,[c("div",se,[oe,R(h(A),{onRegister:h(x),schema:i,rules:b,"hide-required-asterisk":"",class:"dark:border-1 dark:border-[var(--el-border-color)] dark:border-solid"},null,8,["onRegister","schema"]),c("div",ae,[R(n,{loading:l.value,type:"primary",class:"w-[100%]",onClick:I},{default:z(()=>[G(" 重置密碼 ")]),_:1},8,["loading"])])]),c("div",re,[t.value?(v(),K(h(Y),{key:0})):L("",!0)])])}}}),Ce=D(ie,[["__scopeId","data-v-def966f8"]]);export{Ce as default};
